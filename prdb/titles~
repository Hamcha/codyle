Improved coding style
Changed to KNF
Pre-optimization changes
My first contribution
Sorry for the mess
Proposal for indentation
